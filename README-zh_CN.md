# ChatGPT Web NextJS

[![Deploy on Railway](https://railway.app/button.svg)](https://railway.app/template/-4ukN3?referralCode=ZtthnC)

[English](./README.md) | ä¸­æ–‡æ–‡æ¡£

## ä»‹ç»

[chatgpt-web-next](https://github.com/helianthuswhite/chatgpt-web-next) ä½¿ç”¨ `NextJS` å’Œ `TailwindCSS` å®Œæˆå¼€å‘ï¼Œå¹¶ä¸”ä½¿ç”¨ `railway.app` è¿›è¡Œå…è´¹éƒ¨ç½²ã€‚å…·ä½“çš„å¼€å‘å’Œéƒ¨ç½²æ•™ç¨‹å¯ä»¥æŸ¥çœ‹æ–‡ç« [æ­å»ºä¸ªäººä¸“å± ChatGPTï¼ˆé›¶æˆæœ¬ä¸”ä¸éœ€è¦ ğŸªœï¼‰](https://juejin.cn/post/7217057805781516345)ã€‚

ä½ å¯ä»¥é€šè¿‡[chat.helianthuswhite.cn](https://chat.helianthuswhite.cn/)ç½‘ç«™è¿›è¡Œä½“éªŒã€‚è€ƒè™‘åˆ°å®‰å…¨é—®é¢˜ï¼Œè¯¥é¡¹ç›®ä¸ä¼šåœ¨æœåŠ¡ç«¯å­˜å‚¨ä»»ä½•æ•°æ®ï¼Œä¹Ÿä¸ä¼šè¦æ±‚ç”¨æˆ·åœ¨ç½‘ç«™ä¸Šå¡«å†™è‡ªå·±çš„ **API KEY**ã€‚è¯¥é¡¹ç›®çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯é€šè¿‡ localstorage å­˜å‚¨åœ¨ç”¨æˆ·æµè§ˆå™¨æœ¬åœ°ã€‚

**è‹¥ç”¨æˆ·æœ‰ä½¿ç”¨è‡ªå·±çš„ API KEY çš„éœ€æ±‚ï¼Œå¯ä»¥é€šè¿‡ Railway æ¨¡æ¿ä¸€é”®éƒ¨ç½²ï¼Œæˆ–è€… clone æœ¬é¡¹ç›®åˆ°æœ¬åœ°å¹¶åˆ›å»ºè‡ªå·±çš„ç¯å¢ƒå˜é‡æ–‡ä»¶ã€‚**

## å¼€å‘

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ `nextjs` é¡¹ç›®ï¼Œå°†é¡¹ç›® clone åˆ°æœ¬åœ°ä¹‹åä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥å®‰è£…é¡¹ç›®ä¾èµ–ï¼š

    npm install --legacy-peer-deps

æˆ–è€…ä½¿ç”¨ `cnpm` å‘½ä»¤æ¥å®‰è£…:

    cnpm install

ä¾èµ–å®‰è£…å®Œæˆä¹‹åï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª `.env.local` æ–‡ä»¶ç”¨äºå¡«å†™é¡¹ç›®çš„ç¯å¢ƒå˜é‡ã€‚

é¡¹ç›®å¯ä»¥é…ç½®çš„ç¯å¢ƒå¦‚ä¸‹æ‰€ç¤ºï¼š

```yml
# OpenAIå®˜æ–¹çš„api keyæ–‡ä»¶ï¼Œå¯ä»¥åœ¨https://platform.openai.com/overviewè·å–
OPENAI_API_KEY=

# ä»https://chat.openai.com/api/auth/sessionæ¥å£è·å–çš„access_token
OPENAI_ACCESS_TOKEN=

# OpenAIçš„è¯·æ±‚URLï¼Œé»˜è®¤ä¸ºhttps://api.openai.com
OPENAI_API_BASE_URL=

# OpenAIçš„æ¨¡å‹ï¼Œé»˜è®¤ä¸ºgpt3.5-turboï¼Œå…¶ä»–æ¨¡å‹å¯ä»¥åœ¨https://platform.openai.com/docs/modelsæŸ¥è¯¢
OPENAI_API_MODEL=

# ä½¿ç”¨ access_token æ–¹å¼è¯·æ±‚æ—¶ä½¿ç”¨çš„httpä»£ç†åœ°å€
API_REVERSE_PROXY=

# è¯·æ±‚è¶…æ—¶æ—¶é—´
TIMEOUT_MS=100000

# Socksçš„ä»£ç†é…ç½®
SOCKS_PROXY_HOST=

# Socksçš„ä»£ç†ç«¯å£
SOCKS_PROXY_PORT=

# ä¸€ç§ç®€å•çš„æƒé™è®¤è¯é…ç½®ï¼Œå¤šä¸ªtokenä½¿ç”¨é€—å·åˆ†éš”
LOCAL_ACCESS_TOKENS=
```

å¦‚æœé…ç½®å®Œæœ¬åœ°çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥é€šè¿‡ `dev` å‘½ä»¤æ¥å¯åŠ¨é¡¹ç›®:

    npm run dev

## æ„å»ºä¸éƒ¨ç½²

### ä½œä¸º Node æœåŠ¡éƒ¨ç½²

ä½œä¸ºæ™®é€šçš„ Node æœåŠ¡éƒ¨ç½²ï¼Œå¯ä»¥å…ˆé€šè¿‡ `build` å‘½ä»¤æ¥æ„å»ºé¡¹ç›®ã€‚

    npm run build

`nextjs` åœ¨é¡¹ç›®æ„å»ºå®Œæˆä¹‹åï¼Œä¼šåœ¨é¡¹ç›®ç›®å½•ç”Ÿæˆä¸€ä¸ª `.next` æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾äº†æ„å»ºå®Œæˆåçš„äº§ç‰©ï¼Œä¹‹åæˆ‘ä»¬é€šè¿‡ `start` å‘½ä»¤å³å¯å¯åŠ¨é¡¹ç›®ã€‚

    npm run start

ä¹Ÿå¯ä»¥ä½¿ç”¨ `pm2` æ¥ç®¡ç†æˆ‘ä»¬çš„æœåŠ¡ï¼Œ`pm2` çš„å¯åŠ¨å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š

    pm2 start npm -- run start

### ä½¿ç”¨ Docker é•œåƒéƒ¨ç½²

è¯¥é¡¹ç›®ä¹Ÿæä¾›äº†ä½¿ç”¨ Docker é•œåƒéƒ¨ç½²çš„æ–¹å¼ï¼Œå®‰è£…å®Œ Docker å¹¶å¯åŠ¨æœåŠ¡åï¼Œå¯ä»¥åœ¨é¡¹ç›®çš„æ ¹ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ¥åˆ¶ä½œé¡¹ç›®çš„é•œåƒï¼š

    docker build -t chatgpt-web-next .

å…·ä½“çš„é•œåƒåˆ¶ä½œè¿‡ç¨‹å¯ä»¥æŸ¥çœ‹[Dockerfile](./Dockerfile)æ–‡ä»¶ã€‚

å½“æˆ‘ä»¬çš„é•œåƒåˆ¶ä½œå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨æˆ‘ä»¬çš„é•œåƒå¹¶è®¾ç½®é¡¹ç›®æ‰€éœ€è¦çš„ç¯å¢ƒå˜é‡ã€‚

    docker run --name chatgpt -d -p 3000:3000 --env OPENAI_API_KEY=sk-xxxx --env SOCKS_PROXY_HOST=127.0.0.1 --env SOCKS_PROXY_PORT=7890

### ä½¿ç”¨äº‘æœåŠ¡éƒ¨ç½²

**è¿™é‡Œä¼˜å…ˆæ¨èå¤§å®¶ä½¿ç”¨äº‘æœåŠ¡å»è¿›è¡Œéƒ¨ç½²ï¼Œå›½å¤–çš„äº‘æœåŠ¡éƒ½æœ‰å…è´¹çš„é¢åº¦ä¸”ä¸éœ€è¦æˆ‘ä»¬å†é…ç½®ä»£ç†ï¼Œè‡ªå¸¦ ğŸªœï¼Œè¿˜æ˜¯å¾ˆå¥½ç”¨çš„ã€‚**

å¯ä»¥ä½¿ç”¨ [railway.app](https://railway.app/)ã€[vercel](https://vercel.com/)ã€[zeabur](https://zeabur.com/) ç­‰äº‘æœåŠ¡ï¼Œå…·ä½“çš„éƒ¨ç½²æ–¹å¼å¯ä»¥æŸ¥çœ‹å¯¹åº”äº‘æœåŠ¡çš„æ–‡æ¡£ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚

## ç¯å¢ƒå˜é‡

| å˜é‡åç§°              | å¿…å¡«                                          | å˜é‡è¯´æ˜                                                                                                                 |
| --------------------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------ |
| `TIMEOUT_MS`          | å¯é€‰                                          | è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ ms                                                                                                  |
| `OPENAI_API_KEY`      | å¯é€‰                                          | å¦‚æœä½¿ç”¨ API æ–¹å¼è°ƒç”¨å¿…å¡«ï¼Œå¯ä»¥åœ¨[è¿™é‡Œ](https://platform.openai.com/overview)æŸ¥çœ‹ API KEY                                |
| `OPENAI_ACCESS_TOKEN` | å¯é€‰                                          | å¦‚æœä½¿ç”¨ Web API çš„æ–¹å¼è°ƒç”¨å¿…å¡«ï¼Œ`accessToken` æ˜¯é€šè¿‡[è¿™ä¸ªæ¥å£](https://chat.openai.com/api/auth/session)è·å–            |
| `OPENAI_API_BASE_URL` | å¯é€‰, åªæœ‰ `OPENAI_API_KEY` ä¸ä¸ºç©ºæ‰æœ‰æ•ˆ      | API æ–¹å¼è°ƒç”¨çš„åœ°å€ï¼Œé»˜è®¤ä¸ºå®˜æ–¹åœ°å€                                                                                       |
| `OPENAI_API_MODEL`    | å¯é€‰, åªæœ‰ `OPENAI_API_KEY` ä¸ä¸ºç©ºæ‰æœ‰æ•ˆ      | API æ–¹å¼è°ƒç”¨çš„æ¨¡å‹                                                                                                       |
| `API_REVERSE_PROXY`   | å¯é€‰, åªæœ‰ `OPENAI_ACCESS_TOKEN` ä¸ä¸ºç©ºæ‰æœ‰æ•ˆ | `Web API` æ–¹å¼è°ƒç”¨çš„åå‘ä»£ç†åœ°å€ï¼Œå¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/transitive-bullshit/chatgpt-api#reverse-proxy)æŸ¥çœ‹è¯¦æƒ… |
| `SOCKS_PROXY_HOST`    | å¯é€‰ï¼Œè·Ÿ `SOCKS_PROXY_PORT` ä¸€èµ·ä½¿ç”¨          | Socks ä»£ç†åœ°å€                                                                                                           |
| `SOCKS_PROXY_PORT`    | å¯é€‰, è·Ÿ `SOCKS_PROXY_HOST` ä¸€èµ·ä½¿ç”¨          | Socks ä»£ç†ç«¯å£                                                                                                           |
| `LOCAL_ACCESS_TOKENS` | å¯é€‰                                          | ç®€å•æƒé™è®¤è¯çš„ tokenï¼Œéœ€è¦å‰ç«¯è¯·æ±‚æºå¸¦ï¼Œåç«¯éªŒè¯ï¼Œå¤šä¸ª token ä»¥é€—å·åˆ†éš”                                                  |

> æ³¨æ„ï¼šåœ¨ Railway ä¸­æ›´æ–°ç¯å¢ƒå˜é‡ä¼šå¯¼è‡´æœåŠ¡é‡æ–°éƒ¨ç½²ã€‚

## License

MIT Â© [helianthuswhite](./license)
